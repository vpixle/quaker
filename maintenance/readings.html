<!doctype html>
<html>
<head>
<base href="http://quaker.vpixle.com/" />
<link rel="apple-touch-icon-precomposed" href="apple-touch-icon.png">
<link rel="apple-touch-startup-image" href="apple-touch-start.png">  
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<meta http-equiv="content-language" content="en" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta names="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>Quaker - Daily readings</title>
<link rel="stylesheet" href="http://quaker.vpixle.com/jQM/themes/quaker2.min.css" />
<link rel="stylesheet" href="http://quaker.vpixle.com/jQM/css/jquery.mobile-1.2.0-alpha.1.min.css" />

<link rel="stylesheet" href="http://quaker.vpixle.com/jQM/css/custom.css" />

<script src="http://quaker.vpixle.com/jQM/js/jquery-1.7.2.min.js"></script>
<script src="http://quaker.vpixle.com/jQM/js/mobileinit.js" type="text/javascript"></script>
<script src="http://quaker.vpixle.com/jQM/js/ios-orientationchange-fix.min.js" type="text/javascript"></script>
<script src="http://quaker.vpixle.com/jQM/js/application.js" type="text/javascript"></script>
<script src="http://quaker.vpixle.com/jQM/js/jquery.mobile-1.2.0-alpha.1.min.js"></script>
</head>
<body>
<div data-role="page" data-theme="g" id="qkr_231">
  <div data-role="header" data-theme="g" data-position="fixed" data-tap-toggle="false" >
    <h1>Daily readings</h1>
  </div><!-- /header -->
<div data-role="content">
  <form action="" >               
    <h2 id="machine_ref" ></h2>
    <div class="ui-grid-a">                              
      <div class="ui-block-a" >
        <div data-role="fieldcontain">
          <label for="date">Date</label>
          <input type="date" name="date" id="date" value="" disabled />
        </div>                                                          
      </div>                              
      <div class="ui-block-b" style="padding-left: 2em">                                                                                   
        <div data-role="fieldcontain">                                                                    
          <label for="brixfactor">Brix factor
          </label>                                  
          <input type="text" name="brixfactor" id="brixfactor" value= "2.8" style="width:6em;" placeholder="" data-mini="true" step="0.1" data-theme="a" disabled />                                   
        </div>                                                                   
      </div>                      
    </div>                        
    <div data-role="fieldcontain">                                      
      <label for="appearance">Appearance
      </label>                                      
      <select data-native-menu="true" name="appearance" id="appearance">                                              
        <option>Choose one
        </option>      
        <option value="white">Milk white
        </option>                                              
        <option value="grey">Grey
        </option>                                              
        <option value="yellow">Milky yellow
        </option>                                              
        <option value="opaque">Opaque
        </option>                                      
      </select>                              
    </div>          
    <div data-role="fieldcontain">                                      
      <label for="perform">Performance
      </label>                                      
      <select data-native-menu="true" name="perform" id="perform">                                              
        <option>Choose one
        </option>      
        <option value=1>Good
        </option>                                              
        <option value=2>OK
        </option>                                              
        <option value=3>Action Required
        </option>                                              
      </select>                              
    </div>                                           
    <div data-role="fieldcontain">                                                                   
      <label for="ph">pH Reading
      </label>                                        
      <input type="range" name="ph" id="ph" min="0" max="14" value="7.0" step="0.1" data-highlight="true" data-track-theme="g"/>                              
    </div>  
    <div data-role="fieldcontain">                                                                   
      <label for="conc_brix">Brix reading
      </label>                                        
      <input type="range" name="conc_brix" id="conc_brix" min="0" max="30" value="4" step="0.1" data-highlight="true" data-track-theme="g"/>                              
    </div>                         
    <div data-role="fieldcontain" >                                                                    
      <label for="conc_percent">Concentration [%]
      </label>                                  
      <input type="text" name="conc_percent" id="conc_percent" placeholder="" data-mini="true" data-theme="a" disabled />                               
    </div>  
    <div data-role="fieldcontain" >                                                                    
      <label for="product_added_liter">Product added [dm&sup3;]
      </label>                                  
      <input type="number" name="product_added_liter" id="product_added_liter" value="0" min="0" step="1" />                               
    </div>
    <div data-role="fieldcontain" >                                                                    
      <label for="water_added">Water added [dm&sup3;]
      </label>                                  
      <input type="number" name="water_added" id="water_added" value="0" min="0" step="1" />                               
    </div>
    <div data-role="fieldcontain">	
      <label for="additive_added" class="select">Additive(s) added:
      </label>	
      <select name="additive_added" id="additive_added" multiple="multiple" size="4" data-native-menu="false">		
        <option>Choose options
        </option>		
        <option value="biocide">Biocide
        </option>		
        <option value="antifoam">Antifoam
        </option>		
        <option value="detergent">Detergent
        </option>		
        <option value="other">Other
        </option>	
      </select>  
    </div>  
                          
    <div class="ui-grid-a">                              
      <div class="ui-block-a">                                      
        <a href="#" onclick="resetreadings();" data-theme="b" data-icon="delete" data-iconpos="left" data-role="button">Reset</a>
      </div>                              
      <div class="ui-block-b">                                      
        <a href="#" onclick="savereadings();" data-theme="g" data-icon="check" data-iconpos="left" data-role="button">Save</a>
      </div>      
    </div>
</form>            
</div><!-- /content -->
<div data-theme="h" data-role="footer" data-position="fixed" data-tap-toggle="false">                
  <div data-role="navbar" class="nav-glyphish">                    
    <ul>
     <li class="first"><a href="../maintenance/" id="maintenance" data-icon="custom" class="ui-btn-active ui-state-persist" >Maintenance</a></li> 
     <li><a href="../troubleshooting/" id="trouble" data-icon="custom" >Troubleshooting</a></li>
     <li class="last"><a href="../site-setup/" id="sitesetup" data-icon="custom"  >Site Setup</a></li>
    </ul>                
  </div><!-- /navbar -->            
</div><!-- /footer -->
<script>

$('#qkr_231').live('pagebeforeshow', function(event) {
    initDatabase();
    the_id = window.localStorage.getItem("the_id"); //id bylo ulozeno z navratove funkce add
				query = 'SELECT * FROM readings WHERE id="' + the_id + '\"';
    db.transaction(function(tx) {
        tx.executeSql(query, [], function(tx, result) {
												item = result.rows.item(0);
												document.getElementById('machine_ref').innerHTML = item['machine_ref'];
            $("#machine_ref").val(item['machine_ref']);
            $("#brixfactor").val(item['brixfactor']);
            $("#date").val(item['date']);
												resetreadings();
        }, errorHandler);
    });

});

function savereadings() {
    initDatabase();
				the_id = window.localStorage.getItem("the_id");
    db.transaction(function(tx) {  
      tx.executeSql("UPDATE readings SET appearance = ? WHERE id = ?", [appearance.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET perform = ? WHERE id = ?", [perform.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET ph = ? WHERE id = ?", [ph.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET conc_brix = ? WHERE id = ?", [conc_brix.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET conc_percent = ? WHERE id = ?", [conc_percent.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET product_added_liter = ? WHERE id = ?", [product_added_liter.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET water_added = ? WHERE id = ?", [water_added.value, the_id], null, errorHandler);
      tx.executeSql("UPDATE readings SET additive_added = ? WHERE id = ?", [additive_added.value, the_id], null, errorHandler);
    });
				$.mobile.changePage("../maintenance/index.html");  
}

function resetreadings() {
   initDatabase();
			$('#ph').val(7).slider('refresh');
   $('#conc_brix').val(4).slider('refresh');
   $('#product_added_liter').val('0');
   $('#water_added').val('0');
   $('#appearance').val('Choose one').selectmenu('refresh');
   $('#perform').val('Choose one').selectmenu('refresh');
   $('#additive_added').val('Choose options').selectmenu('refresh');
}

</script>

</div><!-- /page -->  
</body>
</html>